<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Notification API デモ</title>
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <div class="container">
      <header>
        <h1>🔔 Notification API デモアプリ</h1>
        <p class="subtitle">ブラウザの通知機能を学習しよう</p>
      </header>

      <!-- 許可状態セクション -->
      <section class="card permission-section">
        <h2>📋 通知の許可状態</h2>
        <div class="permission-status">
          <span>現在のステータス:</span>
          <span id="permission-status" class="status-badge">確認中...</span>
        </div>
        <button id="request-permission" class="btn btn-primary">
          通知の許可を要求
        </button>
        <p class="hint">💡 通知を送信するには、まずブラウザの許可が必要です</p>
      </section>

      <!-- 基本通知セクション -->
      <section class="card">
        <h2>📨 基本的な通知</h2>
        <div class="form-group">
          <label for="basic-title">タイトル:</label>
          <input
            type="text"
            id="basic-title"
            placeholder="通知のタイトルを入力"
            value="テスト通知"
          />
        </div>
        <div class="form-group">
          <label for="basic-body">メッセージ:</label>
          <textarea id="basic-body" rows="3" placeholder="通知の本文を入力">
これは基本的な通知メッセージです</textarea
          >
        </div>
        <button id="send-basic" class="btn btn-success">基本通知を送信</button>
      </section>

      <!-- リッチ通知セクション -->
      <section class="card">
        <h2>✨ リッチ通知</h2>
        <div class="form-group">
          <label for="rich-title">タイトル:</label>
          <input
            type="text"
            id="rich-title"
            placeholder="通知のタイトル"
            value="リッチ通知"
          />
        </div>
        <div class="form-group">
          <label for="rich-body">メッセージ:</label>
          <textarea id="rich-body" rows="3" placeholder="通知の本文">
アイコンやバッジ付きの高度な通知です</textarea
          >
        </div>

        <div class="options-grid">
          <div class="form-group">
            <label>
              <input type="checkbox" id="rich-icon" checked />
              アイコンを表示
            </label>
          </div>
          <div class="form-group">
            <label>
              <input type="checkbox" id="rich-badge" />
              バッジを表示
            </label>
          </div>
          <div class="form-group">
            <label>
              <input type="checkbox" id="rich-image" />
              画像を表示
            </label>
          </div>
          <div class="form-group">
            <label>
              <input type="checkbox" id="rich-require-interaction" />
              操作を要求
            </label>
          </div>
          <div class="form-group">
            <label>
              <input type="checkbox" id="rich-silent" />
              サイレント
            </label>
          </div>
        </div>

        <div class="form-group">
          <label for="rich-tag">タグ（同じタグの通知は置き換わります）:</label>
          <input
            type="text"
            id="rich-tag"
            placeholder="例: update-notification"
          />
        </div>

        <button id="send-rich" class="btn btn-success">リッチ通知を送信</button>
      </section>

      <!-- その他のオプション -->
      <section class="card">
        <h2>🎨 その他のオプション</h2>

        <div class="form-group">
          <label for="vibrate-pattern"
            >振動パターン（ミリ秒, カンマ区切り）:</label
          >
          <input
            type="text"
            id="vibrate-pattern"
            placeholder="例: 200,100,200"
            value="200,100,200"
          />
          <small>※ モバイルデバイスでのみ動作</small>
        </div>

        <div class="form-group">
          <label for="direction">テキストの方向:</label>
          <select id="direction">
            <option value="auto">自動</option>
            <option value="ltr">左から右</option>
            <option value="rtl">右から左</option>
          </select>
        </div>

        <div class="form-group">
          <label for="lang">言語:</label>
          <input type="text" id="lang" placeholder="例: ja, en" value="ja" />
        </div>

        <button id="send-advanced" class="btn btn-success">
          カスタム通知を送信
        </button>
      </section>

      <!-- プリセット通知 -->
      <section class="card">
        <h2>🚀 クイックテスト</h2>
        <div class="preset-buttons">
          <button class="btn btn-secondary" data-preset="success">
            ✅ 成功通知
          </button>
          <button class="btn btn-secondary" data-preset="warning">
            ⚠️ 警告通知
          </button>
          <button class="btn btn-secondary" data-preset="error">
            ❌ エラー通知
          </button>
          <button class="btn btn-secondary" data-preset="info">
            ℹ️ 情報通知
          </button>
        </div>
      </section>

      <!-- ========================================
           Push API セクション（サーバー連携）
           ======================================== -->
      <section class="card push-section">
        <h2>🔥 Push API（サーバーからのプッシュ通知）</h2>
        <p class="subtitle-small">
          サーバーからブラウザにプッシュ通知を送信する機能を試します
        </p>

        <!-- 購読状態 -->
        <div class="push-status-container">
          <div class="push-status">
            <span>購読状態:</span>
            <span id="push-status" class="status-badge">未購読</span>
          </div>
          <div class="push-info">
            <small id="push-info-text">Service Workerを登録してください</small>
          </div>
        </div>

        <!-- Service Worker登録・購読ボタン -->
        <div class="push-actions">
          <button id="register-sw" class="btn btn-primary">
            Service Workerを登録
          </button>
          <button id="subscribe-push" class="btn btn-success" disabled>
            プッシュ通知を購読
          </button>
          <button
            id="unsubscribe-push"
            class="btn"
            style="background: #6b7280"
            disabled
          >
            購読解除
          </button>
        </div>

        <div class="push-divider"></div>

        <!-- プッシュ通知送信 -->
        <div class="push-send-section">
          <h3>📤 サーバーからプッシュ通知を送信</h3>
          <p class="hint">
            💡 購読後、サーバーから通知を送信できます（全購読者に配信）
          </p>

          <div class="form-group">
            <label for="push-title">タイトル:</label>
            <input
              type="text"
              id="push-title"
              placeholder="プッシュ通知のタイトル"
              value="🔥 サーバーからの通知"
            />
          </div>

          <div class="form-group">
            <label for="push-body">メッセージ:</label>
            <textarea id="push-body" rows="3" placeholder="通知の本文">
サーバーからプッシュ通知が届きました！</textarea
            >
          </div>

          <button id="send-push" class="btn btn-success">
            サーバーから通知を送信
          </button>
        </div>

        <!-- 説明 -->
        <div class="push-explanation">
          <h4>💡 Push APIとは？</h4>
          <ul>
            <li>
              <strong>Service Worker</strong>
              がバックグラウンドで動作し、サーバーからの通知を受信
            </li>
            <li>
              <strong>購読（Subscribe）</strong>
              により、ブラウザがプッシュサーバーに登録
            </li>
            <li>
              <strong>PushManager.subscribe()</strong>
              でVAPID公開鍵を使って購読オブジェクトを作成
            </li>
            <li>サーバーは購読オブジェクトを使ってプッシュ通知を送信</li>
            <li>ブラウザが閉じていても通知を受け取れる（OSレベル）</li>
          </ul>
        </div>
      </section>

      <!-- ログ表示エリア -->
      <section class="card log-section">
        <div class="log-header">
          <h2>📜 イベントログ</h2>
          <button id="clear-log" class="btn btn-small">クリア</button>
        </div>
        <div id="log-container" class="log-container">
          <p class="log-empty">ログはここに表示されます</p>
        </div>
      </section>

      <!-- 学習リソース -->
      <section class="card resources">
        <h2>📚 学習リソース</h2>
        <ul>
          <li>
            <a
              href="https://developer.mozilla.org/ja/docs/Web/API/Notifications_API"
              target="_blank"
              >MDN - Notifications API</a
            >
          </li>
          <li>
            <a
              href="https://web.dev/push-notifications-overview/"
              target="_blank"
              >Web.dev - Push Notifications</a
            >
          </li>
          <li>
            <strong>サポートブラウザ:</strong> Chrome, Firefox, Safari, Edge
          </li>
          <li>
            <strong>注意:</strong> HTTPS環境またはlocalhostでのみ動作します
          </li>
        </ul>
      </section>
    </div>

    <script src="/app.js"></script>
  </body>
</html>
